<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Article - ThoughtHive</title>
<style>
body{
  margin:0;
  font-family:Arial,sans-serif;
  background:#121212;
  color:#fff;
  display:flex;
  justify-content:center;
  padding:20px;
  min-height:100vh;
}
.article-box{
  background:rgba(0,0,0,0.4);
  backdrop-filter:blur(12px);
  border-radius:20px;
  padding:25px;
  max-width:700px;
  width:100%;
  box-sizing:border-box;
  box-shadow:0 8px 25px rgba(0,0,0,0.3);
  margin-bottom:20px;
}
h1{text-align:center;margin-top:0;}
p{line-height:1.6;}
button{
  padding:10px 15px;
  border-radius:12px;
  border:none;
  cursor:pointer;
  font-weight:bold;
  margin-top:10px;
  width:100%;
}
button.submit-btn{background:#007bff;color:white;}
button.submit-btn:hover{background:#0056b3;}
button.delete-btn{background:#ff4d4d;color:white;}
button.delete-btn:hover{background:#cc0000;}
button.back-btn{background:#17a2b8;color:white;}
button.back-btn:hover{background:#117a8b;}
#comments-section{margin-top:30px;}
.comment-box{
  background: rgba(255,255,255,0.05);
  padding:10px 15px;
  margin-bottom:12px;
  border-radius:12px;
  backdrop-filter: blur(5px);
}
.comment-box p{margin:5px 0;color:#fff;}
.comment-box strong{font-weight:bold;}
input,textarea{
  width:100%;
  padding:12px;
  margin:10px 0;
  border-radius:12px;
  border:none;
  outline:none;
  font-size:1em;
  background: rgba(255,255,255,0.05);
  color:#fff;
}
textarea{resize:vertical; min-height:80px;}
</style>
</head>
<body>

<div class="article-box">
  <button class="back-btn" onclick="window.location.href='index.html'">‚Üê Back to Home</button>
  <h1 id="article-title">Loading...</h1>
  <p id="article-content"></p>
  <p><strong>By:</strong> <span id="article-author"></span></p>
  <button id="delete-btn" class="delete-btn" style="display:none;" onclick="deleteArticle()">Delete Article</button>

  <div id="comments-section">
    <h3>Comments</h3>
    <input type="text" id="comment-author" placeholder="Your Name">
    <textarea id="comment-text" placeholder="Write your comment"></textarea>
    <button class="submit-btn" onclick="postComment()">Post Comment</button>
    <div id="comments-list"></div>
  </div>
</div>

<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

<script>
const firebaseConfig = {
  apiKey: "AIzaSyAQ4oeDRpMPkpxtcxq-xe7qRwUfIrhUztw",
  authDomain: "thoughthive-ebf0d.firebaseapp.com",
  projectId: "thoughthive-ebf0d",
  storageBucket: "thoughthive-ebf0d.firebasestorage.app",
  messagingSenderId: "254009291887",
  appId: "1:254009291887:web:b5ce7301fb673ba257499a",
  measurementId: "G-5C2Q4SDZ3Y"
};
firebase.initializeApp(firebaseConfig);
const db = firebase.firestore();

const params = new URLSearchParams(window.location.search);
const articleId = params.get('id');

const articleTitleEl = document.getElementById('article-title');
const articleContentEl = document.getElementById('article-content');
const articleAuthorEl = document.getElementById('article-author');
const deleteBtn = document.getElementById('delete-btn');
const commentsList = document.getElementById('comments-list');

async function loadArticle() {
  const doc = await db.collection('articles').doc(articleId).get();
  if(!doc.exists){ alert('Article not found'); return; }
  const data = doc.data();
  articleTitleEl.textContent = data.title;
  articleContentEl.textContent = data.content;
  articleAuthorEl.textContent = data.author;
  if(data.author === 'YOUR_NAME'){ deleteBtn.style.display='block'; } // replace YOUR_NAME
}

async function deleteArticle(){
  if(confirm('Are you sure you want to delete this article?')){
    await db.collection('articles').doc(articleId).delete();
    alert('Article deleted!');
    window.location.href='index.html';
  }
}

function loadComments(){
  db.collection('articles').doc(articleId).collection('comments')
    .orderBy('timestamp','asc')
    .onSnapshot(snapshot=>{
      commentsList.innerHTML='';
      snapshot.forEach(doc=>{
        const c = doc.data();
        const div = document.createElement('div');
        div.className='comment-box';
        div.innerHTML=`<strong>${c.author}:</strong><p>${c.text}</p>`;
        commentsList.appendChild(div);
      });
    });
}

async function postComment(){
  const author=document.getElementById('comment-author').value.trim();
  const text=document.getElementById('comment-text').value.trim();
  if(!author||!text){ alert('Fill all fields'); return; }
  await db.collection('articles').doc(articleId).collection('comments').add({
    author,text,
    timestamp: firebase.firestore.FieldValue.serverTimestamp()
  });
  document.getElementById('comment-author').value='';
  document.getElementById('comment-text').value='';
}

loadArticle();
loadComments();
</script>

</body>
</html>
